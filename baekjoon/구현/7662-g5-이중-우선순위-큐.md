# êµ¬í˜„ - ì´ì¤‘ ìš°ì„ ìˆœìœ„ í [ğŸ”—](https://www.acmicpc.net/problem/7662)

## ë¬¸ì œ

ì´ì¤‘ ìš°ì„ ìˆœìœ„ í(dual priority queue)ëŠ” ì „í˜•ì ì¸ ìš°ì„ ìˆœìœ„ íì²˜ëŸ¼ ë°ì´í„°ë¥¼ ì‚½ì…, ì‚­ì œí•  ìˆ˜ ìˆëŠ” ìë£Œ êµ¬ì¡°ì´ë‹¤. ì „í˜•ì ì¸ íì™€ì˜ ì°¨ì´ì ì€ ë°ì´í„°ë¥¼ ì‚­ì œí•  ë•Œ ì—°ì‚°(operation) ëª…ë ¹ì— ë”°ë¼ ìš°ì„ ìˆœìœ„ê°€ ê°€ì¥ ë†’ì€ ë°ì´í„° ë˜ëŠ” ê°€ì¥ ë‚®ì€ ë°ì´í„° ì¤‘ í•˜ë‚˜ë¥¼ ì‚­ì œí•˜ëŠ” ì ì´ë‹¤. ì´ì¤‘ ìš°ì„ ìˆœìœ„ íë¥¼ ìœ„í•´ì„  ë‘ ê°€ì§€ ì—°ì‚°ì´ ì‚¬ìš©ë˜ëŠ”ë°, í•˜ë‚˜ëŠ” ë°ì´í„°ë¥¼ ì‚½ì…í•˜ëŠ” ì—°ì‚°ì´ê³  ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ë°ì´í„°ë¥¼ ì‚­ì œí•˜ëŠ” ì—°ì‚°ì´ë‹¤. ë°ì´í„°ë¥¼ ì‚­ì œí•˜ëŠ” ì—°ì‚°ì€ ë˜ ë‘ ê°€ì§€ë¡œ êµ¬ë¶„ë˜ëŠ”ë° í•˜ë‚˜ëŠ” ìš°ì„ ìˆœìœ„ê°€ ê°€ì¥ ë†’ì€ ê²ƒì„ ì‚­ì œí•˜ê¸° ìœ„í•œ ê²ƒì´ê³  ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ìš°ì„ ìˆœìœ„ê°€ ê°€ì¥ ë‚®ì€ ê²ƒì„ ì‚­ì œí•˜ê¸° ìœ„í•œ ê²ƒì´ë‹¤. 

ì •ìˆ˜ë§Œ ì €ì¥í•˜ëŠ” ì´ì¤‘ ìš°ì„ ìˆœìœ„ í Qê°€ ìˆë‹¤ê³  ê°€ì •í•˜ì. Qì— ì €ì¥ëœ ê° ì •ìˆ˜ì˜ ê°’ ìì²´ë¥¼ ìš°ì„ ìˆœìœ„ë¼ê³  ê°„ì£¼í•˜ì. 

Qì— ì ìš©ë  ì¼ë ¨ì˜ ì—°ì‚°ì´ ì£¼ì–´ì§ˆ ë•Œ ì´ë¥¼ ì²˜ë¦¬í•œ í›„ ìµœì¢…ì ìœ¼ë¡œ Qì— ì €ì¥ëœ ë°ì´í„° ì¤‘ ìµœëŒ“ê°’ê³¼ ìµœì†Ÿê°’ì„ ì¶œë ¥í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ë¼.

## ì…ë ¥

ì…ë ¥ ë°ì´í„°ëŠ” í‘œì¤€ì…ë ¥ì„ ì‚¬ìš©í•œë‹¤. ì…ë ¥ì€ Tê°œì˜ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ êµ¬ì„±ëœë‹¤. ì…ë ¥ì˜ ì²« ë²ˆì§¸ ì¤„ì—ëŠ” ì…ë ¥ ë°ì´í„°ì˜ ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ìˆ˜ Tê°€ ì£¼ì–´ì§„ë‹¤. ê° í…ŒìŠ¤íŠ¸ ë°ì´í„°ì˜ ì²«ì§¸ ì¤„ì—ëŠ” Qì— ì ìš©í•  ì—°ì‚°ì˜ ê°œìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ìˆ˜ k (k â‰¤ 1,000,000)ê°€ ì£¼ì–´ì§„ë‹¤. ì´ì–´ì§€ëŠ” k ì¤„ ê°ê°ì—” ì—°ì‚°ì„ ë‚˜íƒ€ë‚´ëŠ” ë¬¸ì(â€˜Dâ€™ ë˜ëŠ” â€˜Iâ€™)ì™€ ì •ìˆ˜ nì´ ì£¼ì–´ì§„ë‹¤. â€˜I nâ€™ì€ ì •ìˆ˜ nì„ Qì— ì‚½ì…í•˜ëŠ” ì—°ì‚°ì„ ì˜ë¯¸í•œë‹¤. ë™ì¼í•œ ì •ìˆ˜ê°€ ì‚½ì…ë  ìˆ˜ ìˆìŒì„ ì°¸ê³ í•˜ê¸° ë°”ë€ë‹¤. â€˜D 1â€™ëŠ” Qì—ì„œ ìµœëŒ“ê°’ì„ ì‚­ì œí•˜ëŠ” ì—°ì‚°ì„ ì˜ë¯¸í•˜ë©°, â€˜D -1â€™ëŠ” Q ì—ì„œ ìµœì†Ÿê°’ì„ ì‚­ì œí•˜ëŠ” ì—°ì‚°ì„ ì˜ë¯¸í•œë‹¤. ìµœëŒ“ê°’(ìµœì†Ÿê°’)ì„ ì‚­ì œí•˜ëŠ” ì—°ì‚°ì—ì„œ ìµœëŒ“ê°’(ìµœì†Ÿê°’)ì´ ë‘˜ ì´ìƒì¸ ê²½ìš°, í•˜ë‚˜ë§Œ ì‚­ì œë¨ì„ ìœ ë…í•˜ê¸° ë°”ë€ë‹¤.

ë§Œì•½ Qê°€ ë¹„ì–´ìˆëŠ”ë° ì ìš©í•  ì—°ì‚°ì´ â€˜Dâ€™ë¼ë©´ ì´ ì—°ì‚°ì€ ë¬´ì‹œí•´ë„ ì¢‹ë‹¤. Qì— ì €ì¥ë  ëª¨ë“  ì •ìˆ˜ëŠ” 32-ë¹„íŠ¸ ì •ìˆ˜ì´ë‹¤. 

## ì¶œë ¥

ì¶œë ¥ì€ í‘œì¤€ì¶œë ¥ì„ ì‚¬ìš©í•œë‹¤. ê° í…ŒìŠ¤íŠ¸ ë°ì´í„°ì— ëŒ€í•´, ëª¨ë“  ì—°ì‚°ì„ ì²˜ë¦¬í•œ í›„ Qì— ë‚¨ì•„ ìˆëŠ” ê°’ ì¤‘ ìµœëŒ“ê°’ê³¼ ìµœì†Ÿê°’ì„ ì¶œë ¥í•˜ë¼. ë‘ ê°’ì€ í•œ ì¤„ì— ì¶œë ¥í•˜ë˜ í•˜ë‚˜ì˜ ê³µë°±ìœ¼ë¡œ êµ¬ë¶„í•˜ë¼. ë§Œì•½ Qê°€ ë¹„ì–´ìˆë‹¤ë©´ â€˜EMPTYâ€™ë¥¼ ì¶œë ¥í•˜ë¼.

##### ì…ì¶œë ¥ ì˜ˆ

| ì…ë ¥                                                         | ì¶œë ¥                |
| ------------------------------------------------------------ | ------------------- |
| 2 <br />7 <br />I 16 <br />I -5643 <br />D -1 <br />D 1 <br />D 1 <br />I 123 <br />D -1 <br />9 <br />I -45 <br />I 653 <br />D 1 <br />I -642 <br />I 45 <br />I 97 <br />D 1 <br />D -1 <br />I 333 | EMPTY <br />333 -45 |

## í’€ì´

1. ê¸°ì¡´ í™ì„ ì´ìš©í•´ deletable heapì„ êµ¬í˜„
2. ìµœì†Œ, ìµœëŒ€ 2ê°œì˜ deletable heapì„ ì´ìš©í•´ ì´ì¤‘ ìš°ì„ ìˆœìœ„ íë¥¼ êµ¬í˜„
   - ì‚½ì…ê³¼ ì‚­ì œë¥¼ ìµœì†Œí™, ìµœëŒ€í™ ì–‘ìª½ ëª¨ë‘ì—ì„œ ìˆ˜í–‰í•¨

ì´ì „ì— ë§Œë“¤ì—ˆë˜ í™ì„ ì‚¬ìš©í•˜ë©´ ì‹œê°„ì´ˆê³¼ê°€ ë°œìƒí•´ì„œ heapq ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í–ˆë‹¤. ê·¸ëŸ¼ì—ë„ ì‹œê°„ì´ˆê³¼ê°€ ë°œìƒí•´ì„œ pypy3ìœ¼ë¡œ ì±„ì í•˜ì—¬ ê²¨ìš° í†µê³¼í–ˆë‹¤.

```python
import heapq
import sys

class deletable_heap:
    def __init__(self, is_max):
        self.data = []
        self.deleted = []
        self.is_max = is_max

    def insert(self, value):
        if self.is_max:
            heapq.heappush(self.data, -value)
        else:
            heapq.heappush(self.data, value)

    def delete(self, value):
        if self.is_max:
            heapq.heappush(self.deleted, -value)
        else:
            heapq.heappush(self.deleted, value)

    def top(self):
        self.adjust()
        if len(self.data) == 0:
            return None
        return -self.data[0] if self.is_max else self.data[0]

    def adjust(self):
        while len(self.deleted) and self.data[0] == self.deleted[0]:
            heapq.heappop(self.data)
            heapq.heappop(self.deleted)

class dual_priority_queue:
    def __init__(self):
        self.max_heap = deletable_heap(True)
        self.min_heap = deletable_heap(False)

    def insert(self, value):
        self.max_heap.insert(value)
        self.min_heap.insert(value)

    def delete(self, is_max):
        to_delete = self.max_heap.top() if is_max else self.min_heap.top()
        if to_delete == None:
            return
        self.max_heap.delete(to_delete)
        self.min_heap.delete(to_delete)

    def print_top(self):
        max_top = self.max_heap.top()
        min_top = self.min_heap.top()
        if max_top == None or min_top == None:
            print('EMPTY')
        else:
            print(max_top, min_top)

read = sys.stdin.readline

def solution():
    k = int(read().strip())
    dpq = dual_priority_queue()
    for _ in range(k):
        operation = input()
        if operation[0] == 'I':
            dpq.insert(int(operation.split()[1]))
        else:
            dpq.delete(True if operation.split()[1] == '1' else False)
    dpq.print_top()

T = int(read().strip())
for _ in range(T):
    solution()

```